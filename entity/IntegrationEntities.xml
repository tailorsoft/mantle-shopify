<?xml version="1.0" encoding="UTF-8"?>
<entities xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/entity-definition-2.1.xsd">
    <extend-entity entity-name="SystemMessage" package="moqui.service.message">
        <field name="productId" type="id"/>
        <relationship type="one" related="mantle.product.Product"/>
    </extend-entity>
    <extend-entity entity-name="SystemMessage" package="moqui.service.message">
        <field name="productCategoryId" type="id"/>
        <relationship type="one" related="mantle.product.category.ProductCategory"/>
    </extend-entity>
    <extend-entity entity-name="ProductCategoryMember" package="mantle.product.category">
        <field name="shopifyId" type="id"/>
    </extend-entity>

    <extend-entity entity-name="Party" package="mantle.party">
        <field name="shopifyTrackingCompany" type="text-short"/>
        <field name="shopifyCustomerId" type="id"/>
    </extend-entity>

    <view-entity entity-name="CustomerInfoView" package="brokerageengine.party.customer">
        <member-entity entity-alias="PTY" entity-name="mantle.party.Party" />
        <member-entity entity-alias="PTR" join-from-alias="PTY" entity-name="mantle.party.PartyRole" join-optional="true" >
            <key-map field-name="partyId" related="partyId" />
        </member-entity>

        <member-entity entity-alias="PER" join-from-alias="PTY" entity-name="mantle.party.Person" join-optional="true" >
            <key-map field-name="partyId" related="partyId" />
        </member-entity>

        <member-entity entity-alias="PCTM" join-from-alias="PTY" entity-name="mantle.party.contact.PartyContactMech" join-optional="true" >
            <key-map field-name="partyId" related="partyId" />
            <entity-condition>
                <econditions>
                    <econdition entity-alias="PCTM" field-name="thruDate" operator="is-null"/>
                </econditions>
            </entity-condition>
        </member-entity>

        <member-entity entity-alias="PSTA" join-from-alias="PCTM" entity-name="mantle.party.contact.PostalAddress" join-optional="true" >
            <key-map field-name="contactMechId" related="contactMechId" />
        </member-entity>

        <member-entity entity-alias="TEL" join-from-alias="PCTM" entity-name="mantle.party.contact.TelecomNumber" join-optional="true" >
            <key-map field-name="contactMechId" related="contactMechId" />
        </member-entity>

        <member-entity entity-alias="GEO" join-from-alias="PSTA" entity-name="moqui.basic.Geo" join-optional="true" >
            <key-map field-name="countryGeoId" related="countryGeoId" />
        </member-entity>

        <member-entity entity-alias="CTM" join-from-alias="PCTM" entity-name="mantle.party.contact.ContactMech" join-optional="true" >
            <key-map field-name="contactMechId" related="contactMechId" />
        </member-entity>

        <alias entity-alias="PTR" field="roleTypeId" name="roleTypeId"/>
        <alias entity-alias="PTY" field="partyId" name="partyId"/>
        <alias entity-alias="PER" field="firstName" name="firstName"/>
        <alias entity-alias="PER" field="lastName" name="lastName"/>
        <alias entity-alias="CTM" field="infoString" name="email"/>
        <alias entity-alias="PSTA" field="address1" name="address1"/>
        <alias entity-alias="PSTA" field="address2" name="address2"/>
        <alias entity-alias="PSTA" field="city" name="city"/>
        <alias entity-alias="GEO" field="geoName" name="country"/>
        <alias entity-alias="GEO" field="geoCodeAlpha2" name="countryCode"/>
        <alias entity-alias="PSTA" field="postalCode" name="zip"/>
        <alias entity-alias="TEL" field="contactNumber" name="phone"/>

        <entity-condition>
            <econditions>
                <econdition entity-alias="PTR" field-name="roleTypeId" operator="equals" value="Customer"/>
            </econditions>
        </entity-condition>
    </view-entity>

</entities>